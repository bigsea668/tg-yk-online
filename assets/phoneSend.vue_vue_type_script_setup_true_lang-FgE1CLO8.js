import{d as G,t as d,z as Z,b as v,a4 as o,i as p,o as f,e as s,Y as n,Z as O,a0 as H,H as q,I as se,J as M,a3 as D,$ as A,a9 as J,aa as w,aI as le,au as oe,ad as ae,h as K}from"./index-DNkZCZKw.js";import{b as Q,c as ne,e as ie}from"./el-select-CZyzFNTt.js";import{E as ce}from"./el-input-C7PQpcn4.js";import{E as W}from"./el-button-BBd7XdAz.js";import{b as X,E as re}from"./el-scrollbar-CNZ0YxQa.js";import{E as ue,a as pe,i as de,s as fe,_ as me}from"./el-step-DB2KJaoR.js";import{I as N}from"./iconify-DdIyU_s5.js";import{b as ee}from"./account-D4zKK7eJ.js";import{_ as ve}from"./accountList.vue_vue_type_script_setup_true_lang-DpRXLiBM.js";import"./el-tooltip-l0sNRNKZ.js";import"./el-tag-B3vrMW3X.js";import{i as he}from"./utils-IFbqXvBV.js";import{_ as _e}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{s as ye,f as ge}from"./im-kqJHyd-y.js";import{a as Y}from"./account.StatusEnum-D3Ud_gcQ.js";const we={key:0,class:"mt-4"},be={class:"mt-4 pt-4",style:{"border-top":"1px dashed #ccc"}},xe={class:"mt-4"},ke={key:0},Ne={class:"w-3/4"},Ce={key:1},$e={class:"w-3/4"},Ee={class:"mt-4 pt-4",style:{"border-top":"1px dashed #ccc"}},st=G({__name:"importToCon",props:["show","multipleSelect"],emits:["up:show"],setup(T,{emit:S}){const c=T,b=S,r=d([]),m=d([]);Z(()=>c.show,()=>{c.show&&($(),c.multipleSelect.forEach(t=>{t.phone!=null&&t.phone!=null&&t.phone!=""?r.value.push(t.phone):t.mainName!=null&&t.mainName!=null&&t.mainName!=""&&m.value.push(t.mainName)}))});const h=d(!1),I=d([]);function $(){h.value=!0,ee().then(t=>{try{I.value=t.data.data.data.map(e=>({status:e.account.status,value:e.account.id,label:e.account.nickName,phone:e.account.phone}))}catch{}}).catch(t=>{}).finally(()=>{h.value=!1})}function k(){if(r.value.length>0){const t=c.multipleSelect.map(y=>({phone:String(y.phone),fristName:y.firstName,lastName:y.lastName})),e={id:g.value,phones:t};de(e).then(y=>{y.data,w.success("导入为联系人成功")}).catch(y=>{w.error("导入为联系人失败")})}if(m.value.length>0){const t=new FormData;t.append("id",String(g.value)),t.append("maxSendNumber",String(m.value.length)),t.append("remark","批量导入用户名联系人"),t.append("msg",x.value),m.value.length!=0&&m.value.forEach(e=>{t.append("userLinks",e)}),fe(t).then(e=>{e.data,w.success("导入为联系人成功")}).catch(e=>{w.error("导入为联系人失败")})}E()}function E(){b("up:show",!1),u.value=0,r.value=[],m.value=[],g.value=-1,x.value=""}const F=d(0),g=d(-1);function P(t){g.value=t}const u=d(0);function _(){u.value++,F.value=g.value}const x=d("Hi");function j(){k()}function U(){u.value--,x.value=""}function a(t){r.value.splice(t,1)}function l(t){m.value.splice(t,1)}return(t,e)=>{const y=ue,B=pe,V=X,i=W,L=ce,R=Q;return f(),v("div",null,[o(R,{modelValue:c.show,"onUpdate:modelValue":e[1]||(e[1]=C=>c.show=C),title:"导入联系人",width:"500",onClose:E},{default:p(()=>[o(B,{style:{"max-width":"300px"},active:s(u),"finish-status":"success"},{default:p(()=>[o(y,{title:"选择账号"}),o(y,{title:"设置参数"})]),_:1},8,["active"]),s(u)===0?(f(),v("div",we,[o(V,{class:"w-full overflow-y-auto",style:{height:"30vh"}},{default:p(()=>[o(ve,{onAccountId:P})]),_:1}),n("div",be,[o(i,{type:"primary",plain:"",onClick:_,disabled:s(g)==-1},{default:p(()=>e[2]||(e[2]=[O("下一步")])),_:1},8,["disabled"])])])):H("",!0),q(n("div",xe,[s(r).length>0?(f(),v("div",ke,[e[3]||(e[3]=n("div",{class:"p-2 mb-2",style:{"border-left":"5px solid #409eff"}},"导入联系人号码",-1)),o(V,{class:"w-full overflow-y-auto",style:{"max-height":"25vh",border:"1px solid #ccc"}},{default:p(()=>[(f(!0),v(M,null,D(s(r),(C,z)=>(f(),v("div",{key:z,class:"p-0.5 flex justify-between"},[n("div",Ne,A(C),1),o(i,{type:"primary",plain:"",class:"w-1/4",onClick:te=>a(z)},{default:p(()=>[o(s(N),{icon:"ic:baseline-delete",style:{"font-size":"22px"}})]),_:2},1032,["onClick"])]))),128))]),_:1})])):H("",!0),s(m).length>0?(f(),v("div",Ce,[e[4]||(e[4]=n("div",{class:"p-2 mb-2",style:{"border-left":"5px solid #409eff"}},"导入用户名",-1)),o(V,{class:"w-full overflow-y-auto",style:{"max-height":"25vh",border:"1px solid #ccc"}},{default:p(()=>[(f(!0),v(M,null,D(s(m),(C,z)=>(f(),v("div",{key:z,class:"p-0.5 flex justify-between"},[n("div",$e,A(C),1),o(i,{type:"primary",plain:"",class:"w-1/4",onClick:te=>l(z)},{default:p(()=>[o(s(N),{icon:"ic:baseline-delete",style:{"font-size":"22px"}})]),_:2},1032,["onClick"])]))),128))]),_:1}),e[5]||(e[5]=n("div",{class:"p-2 mb-2",style:{"border-left":"5px solid #409eff"}},"输入消息（注：添加用户名的账号为联系人时需要发送首条消息）",-1)),o(L,{modelValue:s(x),"onUpdate:modelValue":e[0]||(e[0]=C=>J(x)?x.value=C:null),style:{width:"240px"},placeholder:"输入消息"},null,8,["modelValue"])])):H("",!0),n("div",Ee,[o(i,{type:"primary",plain:"",onClick:U},{default:p(()=>e[6]||(e[6]=[O("上一步")])),_:1}),o(i,{type:"primary",plain:"",onClick:j,disabled:s(m).length>0?s(x)=="":s(r).length<0},{default:p(()=>e[7]||(e[7]=[O("确认导入")])),_:1},8,["disabled"])])],512),[[se,s(u)===1]])]),_:1},8,["modelValue"])])}}}),Se={class:"h-3/4 w-full flex justify-between items-center",style:{border:"1px solid #ccc"}},Ie={class:"message-input-container"},Ve=["onKeydown","placeholder"],Le=G({__name:"send",emits:["send"],setup(T,{emit:S}){const c=S,b=d(""),r=d(),m=()=>{r.value&&(r.value.style.height="auto",r.value.style.height=`${r.value.scrollHeight}px`)};function h(){c("send",b.value),b.value=""}return(I,$)=>{const k=X;return f(),v("div",Se,[n("div",Ie,[o(k,{class:"scrollbar",height:100},{default:p(()=>[q(n("textarea",{"onUpdate:modelValue":$[0]||($[0]=E=>J(b)?b.value=E:null),onInput:m,onKeydown:oe(ae(h,["prevent"]),["enter"]),placeholder:I.$t("btn.inputSearch"),ref_key:"messageInput",ref:r,class:"message-input"},null,40,Ve),[[le,s(b)]])]),_:1})]),n("div",{class:"flex items-center justify-center text-sky-500 bg-white h-full w-1/6 hover:bg-sky-500 hover:text-white cursor-pointer transition duration-300 ease-in-out",style:{"border-left":"1px solid #ccc"},onClick:h},[o(s(N),{icon:"cib:telegram-plane",style:{"font-size":"32px"}})])])}}}),ze=_e(Le,[["__scopeId","data-v-35d807ab"]]),Me={class:"flex items-center"},Ae={style:{float:"left"}},Te={style:{float:"right"}},Ue={style:{float:"right",color:"var(--el-text-color-secondary)","font-size":"13px"}},De={class:"flex items-center mt-2"},Fe={class:"mt-4"},Pe={class:"flex items-center h-8 w-64 overflow-hidden whitespace-nowrap truncate"},je=["onClick"],lt=G({__name:"phoneSend",props:["show","phone","mainName"],emits:["up:show"],setup(T,{emit:S}){const c=T,b=S;Z(()=>c.show,()=>{I()});const r=d(!1),m=d([]),h=d("");function I(){r.value=!0,ee().then(a=>{try{m.value=a.data.data.data.map(l=>({status:l.account.status,value:l.account.id,label:l.account.nickName,phone:l.account.phone}))}catch{}}).catch(a=>{}).finally(()=>{r.value=!1})}function $(a){a.status!=Y.Online&&(w.error("该账号未登录"),h.value="")}const k=d("");function E(){const a=new FormData;c.phone&&a.append("Phone",c.phone),c.mainName&&a.append("UserName",c.mainName),a.append("Id",h.value),k.value&&a.append("Text",k.value),u.value&&u.value.forEach(l=>{a.append("files.UrlFiles",l)}),_.value&&_.value.forEach(l=>{a.append("files.UrlFileTypes",l)}),w.info("私聊消息已发送"),c.phone?ye(a).then(l=>{l.data,w.success("私聊消息发送成功")}).catch(l=>{w.error("私聊消息发送失败")}):c.mainName&&ge(a).then(l=>{l.data,w.success("私聊消息发送成功")}).catch(l=>{w.error("私聊消息发送失败")}),U()}function F(a){k.value=a,E()}const g=d(!1);function P(){g.value=!0}const u=d(),_=d();function x(a,l,t,e){g.value=a,t.length>0&&e.length>0&&(Array.isArray(u.value)||(u.value=[]),Array.isArray(_.value)||(_.value=[]),u.value=[...u.value,...t],_.value=[..._.value,...e])}function j(a){u.value&&_.value&&(u.value.splice(a,1),_.value.splice(a,1))}function U(){b("up:show",!1),k.value="",u.value=[],_.value=[]}return(a,l)=>{const t=ne,e=ie,y=W,B=re,V=Q;return f(),v(M,null,[o(V,{modelValue:c.show,"onUpdate:modelValue":l[1]||(l[1]=i=>c.show=i),title:"发送私聊消息",width:"700",onClose:U},{footer:p(()=>[o(ze,{onSend:F})]),default:p(()=>[n("div",Me,[l[2]||(l[2]=n("span",{class:"w-2/12"},"选择账号",-1)),o(e,{modelValue:s(h),"onUpdate:modelValue":l[0]||(l[0]=i=>J(h)?h.value=i:null),placeholder:"请选择账号",filterable:"",size:"large",class:"w-10/12",loading:s(r)},{default:p(()=>[(f(!0),v(M,null,D(s(m),i=>(f(),K(t,{key:i.value,label:i.label,value:i.value,onClick:L=>$(i)},{default:p(()=>[n("span",Ae,A(i.label),1),n("span",Te,[i.status===s(Y).Online?(f(),K(s(N),{key:0,icon:"ic:round-lens",style:{"font-size":"10px"},class:"ml-2 text-green-600"})):(f(),K(s(N),{key:1,icon:"ic:round-lens",style:{"font-size":"10px"},class:"ml-2 text-red-600"}))]),n("span",Ue,A(i.phone),1)]),_:2},1032,["label","value","onClick"]))),128))]),_:1},8,["modelValue","loading"])]),n("div",null,[n("div",De,[l[3]||(l[3]=n("span",{class:"w-2/12"},"发送文件",-1)),o(y,{type:"primary",plain:"",onClick:P,class:"w-4/12 -ml-4"},{default:p(()=>[o(s(N),{icon:"bxs:file",style:{"font-size":"22px"}})]),_:1})]),n("div",Fe,[(f(!0),v(M,null,D(s(u),(i,L)=>(f(),v("div",{key:L,class:"flex items-center justify-between w-80 ml-24",style:{border:"1px dashed #ccc"}},[o(s(N),{icon:"bxs:file",style:{"font-size":"22px"}}),o(B,{class:"box-item",effect:"dark",content:i,placement:"bottom"},{default:p(()=>[n("span",Pe,A(("interceptName"in a?a.interceptName:s(he))(i)),1)]),_:2},1032,["content"]),n("span",{type:"danger",plain:"",onClick:R=>j(L)},[o(s(N),{icon:"mynaui:delete-solid",class:"hover:text-red-500 cursor-pointer",style:{"font-size":"22px"}})],8,je)]))),128))])])]),_:1},8,["modelValue"]),o(me,{show:s(g),isLocal:!1,onDeliver:x},null,8,["show"])],64)}}});export{st as _,lt as a};
