import{d as G,t as d,z as Z,b as v,a4 as a,i as p,o as f,e as o,Y as n,Z as O,a0 as H,H as q,I as se,J as M,a3 as D,$ as A,a9 as J,aa as w,aI as oe,au as le,ad as ae,h as K}from"./index-2a2bri-d.js";import{b as Q,c as ne,e as ie}from"./el-select-Dz2KJnwc.js";import{E as ce}from"./el-input-DOfSdrh_.js";import{E as W}from"./el-button-D_fjb_vJ.js";import{b as X,E as re}from"./el-scrollbar-CXPZY7Bs.js";import{E as ue,a as pe,i as de,s as fe,_ as me}from"./el-step-DN_0vMak.js";import{I as N}from"./iconify-BO38E5Xh.js";import{b as ee}from"./account-BYfcswwO.js";import{_ as ve}from"./accountList.vue_vue_type_script_setup_true_lang-BLpQhr_P.js";import"./el-tooltip-l0sNRNKZ.js";import"./el-tag-BySgfF3p.js";import{i as he}from"./utils-DaTdCYcK.js";import{_ as _e}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{s as ye,f as ge}from"./im-DDAOu1MQ.js";import{a as Y}from"./account.StatusEnum-CqjSWtZY.js";const we={key:0,class:"mt-4"},be={class:"mt-4 pt-4",style:{"border-top":"1px dashed #ccc"}},xe={class:"mt-4"},ke={key:0},Ne={class:"w-3/4"},Ce={key:1},$e={class:"w-3/4"},Ee={class:"mt-4 pt-4",style:{"border-top":"1px dashed #ccc"}},st=G({__name:"importToCon",props:["show","multipleSelect"],emits:["up:show"],setup(T,{emit:S}){const c=T,b=S,r=d([]),m=d([]);Z(()=>c.show,()=>{c.show&&($(),c.multipleSelect.forEach(t=>{t.phone!=null&&t.phone!=null&&t.phone!=""?r.value.push(t.phone):t.mainName!=null&&t.mainName!=null&&t.mainName!=""&&m.value.push(t.mainName)}))});const _=d(!1),I=d([]);function $(){_.value=!0,ee().then(t=>{try{I.value=t.data.data.data.map(e=>({status:e.account.status,value:e.account.id,label:e.account.nickName,phone:e.account.phone}))}catch(e){console.log(e)}}).catch(t=>{console.log("获取账号列表失败",t)}).finally(()=>{_.value=!1})}function k(){if(r.value.length>0){const t=c.multipleSelect.map(h=>({phone:String(h.phone),fristName:h.firstName,lastName:h.lastName})),e={id:g.value,phones:t};de(e).then(h=>{console.log("导入为联系人成功",h.data),w.success("导入为联系人成功")}).catch(h=>{console.log("导入为联系人失败",h),w.error("导入为联系人失败")})}if(m.value.length>0){const t=new FormData;t.append("id",String(g.value)),t.append("maxSendNumber",String(m.value.length)),t.append("remark","批量导入用户名联系人"),t.append("msg",x.value),m.value.length!=0&&m.value.forEach(e=>{t.append("userLinks",e)}),fe(t).then(e=>{console.log("导入为联系人成功",e.data),w.success("导入为联系人成功")}).catch(e=>{console.log("导入为联系人失败",e),w.error("导入为联系人失败")})}E()}function E(){console.log("取消导入"),b("up:show",!1),u.value=0,r.value=[],m.value=[],g.value=-1,x.value=""}const F=d(0),g=d(-1);function P(t){g.value=t}const u=d(0);function y(){u.value++,F.value=g.value}const x=d("Hi");function j(){k()}function U(){u.value--,x.value=""}function l(t){r.value.splice(t,1)}function s(t){m.value.splice(t,1)}return(t,e)=>{const h=ue,B=pe,V=X,i=W,L=ce,R=Q;return f(),v("div",null,[a(R,{modelValue:c.show,"onUpdate:modelValue":e[1]||(e[1]=C=>c.show=C),title:"导入联系人",width:"500",onClose:E},{default:p(()=>[a(B,{style:{"max-width":"300px"},active:o(u),"finish-status":"success"},{default:p(()=>[a(h,{title:"选择账号"}),a(h,{title:"设置参数"})]),_:1},8,["active"]),o(u)===0?(f(),v("div",we,[a(V,{class:"w-full overflow-y-auto",style:{height:"30vh"}},{default:p(()=>[a(ve,{onAccountId:P})]),_:1}),n("div",be,[a(i,{type:"primary",plain:"",onClick:y,disabled:o(g)==-1},{default:p(()=>e[2]||(e[2]=[O("下一步")])),_:1},8,["disabled"])])])):H("",!0),q(n("div",xe,[o(r).length>0?(f(),v("div",ke,[e[3]||(e[3]=n("div",{class:"p-2 mb-2",style:{"border-left":"5px solid #409eff"}},"导入联系人号码",-1)),a(V,{class:"w-full overflow-y-auto",style:{"max-height":"25vh",border:"1px solid #ccc"}},{default:p(()=>[(f(!0),v(M,null,D(o(r),(C,z)=>(f(),v("div",{key:z,class:"p-0.5 flex justify-between"},[n("div",Ne,A(C),1),a(i,{type:"primary",plain:"",class:"w-1/4",onClick:te=>l(z)},{default:p(()=>[a(o(N),{icon:"ic:baseline-delete",style:{"font-size":"22px"}})]),_:2},1032,["onClick"])]))),128))]),_:1})])):H("",!0),o(m).length>0?(f(),v("div",Ce,[e[4]||(e[4]=n("div",{class:"p-2 mb-2",style:{"border-left":"5px solid #409eff"}},"导入用户名",-1)),a(V,{class:"w-full overflow-y-auto",style:{"max-height":"25vh",border:"1px solid #ccc"}},{default:p(()=>[(f(!0),v(M,null,D(o(m),(C,z)=>(f(),v("div",{key:z,class:"p-0.5 flex justify-between"},[n("div",$e,A(C),1),a(i,{type:"primary",plain:"",class:"w-1/4",onClick:te=>s(z)},{default:p(()=>[a(o(N),{icon:"ic:baseline-delete",style:{"font-size":"22px"}})]),_:2},1032,["onClick"])]))),128))]),_:1}),e[5]||(e[5]=n("div",{class:"p-2 mb-2",style:{"border-left":"5px solid #409eff"}},"输入消息（注：添加用户名的账号为联系人时需要发送首条消息）",-1)),a(L,{modelValue:o(x),"onUpdate:modelValue":e[0]||(e[0]=C=>J(x)?x.value=C:null),style:{width:"240px"},placeholder:"输入消息"},null,8,["modelValue"])])):H("",!0),n("div",Ee,[a(i,{type:"primary",plain:"",onClick:U},{default:p(()=>e[6]||(e[6]=[O("上一步")])),_:1}),a(i,{type:"primary",plain:"",onClick:j,disabled:o(m).length>0?o(x)=="":o(r).length<0},{default:p(()=>e[7]||(e[7]=[O("确认导入")])),_:1},8,["disabled"])])],512),[[se,o(u)===1]])]),_:1},8,["modelValue"])])}}}),Se={class:"h-3/4 w-full flex justify-between items-center",style:{border:"1px solid #ccc"}},Ie={class:"message-input-container"},Ve=["onKeydown","placeholder"],Le=G({__name:"send",emits:["send"],setup(T,{emit:S}){const c=S,b=d(""),r=d(),m=()=>{r.value&&(r.value.style.height="auto",r.value.style.height=`${r.value.scrollHeight}px`)};function _(){c("send",b.value),b.value=""}return(I,$)=>{const k=X;return f(),v("div",Se,[n("div",Ie,[a(k,{class:"scrollbar",height:100},{default:p(()=>[q(n("textarea",{"onUpdate:modelValue":$[0]||($[0]=E=>J(b)?b.value=E:null),onInput:m,onKeydown:le(ae(_,["prevent"]),["enter"]),placeholder:I.$t("btn.inputSearch"),ref_key:"messageInput",ref:r,class:"message-input"},null,40,Ve),[[oe,o(b)]])]),_:1})]),n("div",{class:"flex items-center justify-center text-sky-500 bg-white h-full w-1/6 hover:bg-sky-500 hover:text-white cursor-pointer transition duration-300 ease-in-out",style:{"border-left":"1px solid #ccc"},onClick:_},[a(o(N),{icon:"cib:telegram-plane",style:{"font-size":"32px"}})])])}}}),ze=_e(Le,[["__scopeId","data-v-35d807ab"]]),Me={class:"flex items-center"},Ae={style:{float:"left"}},Te={style:{float:"right"}},Ue={style:{float:"right",color:"var(--el-text-color-secondary)","font-size":"13px"}},De={class:"flex items-center mt-2"},Fe={class:"mt-4"},Pe={class:"flex items-center h-8 w-64 overflow-hidden whitespace-nowrap truncate"},je=["onClick"],ot=G({__name:"phoneSend",props:["show","phone","mainName"],emits:["up:show"],setup(T,{emit:S}){const c=T,b=S;Z(()=>c.show,()=>{I()});const r=d(!1),m=d([]),_=d("");function I(){r.value=!0,ee().then(l=>{try{m.value=l.data.data.data.map(s=>({status:s.account.status,value:s.account.id,label:s.account.nickName,phone:s.account.phone}))}catch(s){console.log(s)}}).catch(l=>{console.log("获取账号列表失败",l)}).finally(()=>{r.value=!1})}function $(l){console.log("校验",l),l.status!=Y.Online&&(w.error("该账号未登录"),_.value="")}const k=d("");function E(){const l=new FormData;c.phone&&l.append("Phone",c.phone),c.mainName&&l.append("UserName",c.mainName),l.append("Id",_.value),k.value&&l.append("Text",k.value),u.value&&u.value.forEach(s=>{l.append("files.UrlFiles",s)}),y.value&&y.value.forEach(s=>{l.append("files.UrlFileTypes",s)}),w.info("私聊消息已发送"),c.phone?ye(l).then(s=>{console.log("手机发送消息成功",s.data),w.success("私聊消息发送成功")}).catch(s=>{console.log("手机发送消息失败",s),w.error("私聊消息发送失败")}):c.mainName&&ge(l).then(s=>{console.log("用户名发送消息成功",s.data),w.success("私聊消息发送成功")}).catch(s=>{console.log("用户名发送消息失败",s),w.error("私聊消息发送失败")}),U()}function F(l){k.value=l,E()}const g=d(!1);function P(){g.value=!0}const u=d(),y=d();function x(l,s,t,e){g.value=l,t.length>0&&e.length>0&&(Array.isArray(u.value)||(u.value=[]),Array.isArray(y.value)||(y.value=[]),u.value=[...u.value,...t],y.value=[...y.value,...e])}function j(l){u.value&&y.value&&(u.value.splice(l,1),y.value.splice(l,1))}function U(){b("up:show",!1),k.value="",u.value=[],y.value=[]}return(l,s)=>{const t=ne,e=ie,h=W,B=re,V=Q;return f(),v(M,null,[a(V,{modelValue:c.show,"onUpdate:modelValue":s[1]||(s[1]=i=>c.show=i),title:"发送私聊消息",width:"700",onClose:U},{footer:p(()=>[a(ze,{onSend:F})]),default:p(()=>[n("div",Me,[s[2]||(s[2]=n("span",{class:"w-2/12"},"选择账号",-1)),a(e,{modelValue:o(_),"onUpdate:modelValue":s[0]||(s[0]=i=>J(_)?_.value=i:null),placeholder:"请选择账号",filterable:"",size:"large",class:"w-10/12",loading:o(r)},{default:p(()=>[(f(!0),v(M,null,D(o(m),i=>(f(),K(t,{key:i.value,label:i.label,value:i.value,onClick:L=>$(i)},{default:p(()=>[n("span",Ae,A(i.label),1),n("span",Te,[i.status===o(Y).Online?(f(),K(o(N),{key:0,icon:"ic:round-lens",style:{"font-size":"10px"},class:"ml-2 text-green-600"})):(f(),K(o(N),{key:1,icon:"ic:round-lens",style:{"font-size":"10px"},class:"ml-2 text-red-600"}))]),n("span",Ue,A(i.phone),1)]),_:2},1032,["label","value","onClick"]))),128))]),_:1},8,["modelValue","loading"])]),n("div",null,[n("div",De,[s[3]||(s[3]=n("span",{class:"w-2/12"},"发送文件",-1)),a(h,{type:"primary",plain:"",onClick:P,class:"w-4/12 -ml-4"},{default:p(()=>[a(o(N),{icon:"bxs:file",style:{"font-size":"22px"}})]),_:1})]),n("div",Fe,[(f(!0),v(M,null,D(o(u),(i,L)=>(f(),v("div",{key:L,class:"flex items-center justify-between w-80 ml-24",style:{border:"1px dashed #ccc"}},[a(o(N),{icon:"bxs:file",style:{"font-size":"22px"}}),a(B,{class:"box-item",effect:"dark",content:i,placement:"bottom"},{default:p(()=>[n("span",Pe,A(("interceptName"in l?l.interceptName:o(he))(i)),1)]),_:2},1032,["content"]),n("span",{type:"danger",plain:"",onClick:R=>j(L)},[a(o(N),{icon:"mynaui:delete-solid",class:"hover:text-red-500 cursor-pointer",style:{"font-size":"22px"}})],8,je)]))),128))])])]),_:1},8,["modelValue"]),a(me,{show:o(g),isLocal:!1,onDeliver:x},null,8,["show"])],64)}}});export{st as _,ot as a};
